<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="theme-color" content="#ffffff"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="author" content="Marx J. Moura"><meta name="description" content="To implement the microservice architecture pattern, we build a collection of APIs with specific responsibilities that work together and communicate through events. Let&#x27;s see how we can do this."><meta property="og:title" content="Microservice architecture with ASP.NET Core"><meta property="og:image" content="https://fullstack.app/posts/2019/08/28/cover.png"><meta property="og:description" content="To implement the microservice architecture pattern, we build a collection of APIs with specific responsibilities that work together and communicate through events. Let&#x27;s see how we can do this."><meta property="og:url" content="https://fullstack.app/posts/2019/08/28/microservice-architecture-with-aspnet-core.html"><title>Microservice architecture with ASP.NET Core</title><link rel="icon" href="/favicon.ico"><link rel="alternate" href="https://fullstack.app/br/posts/2019/08/28/arquitetura-de-microsservicos-com-aspnet-core.html" hreflang="br"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Serif+Pro:400,700&display=swap"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css" integrity="sha256-UzFD2WYH2U1dQpKDjjZK72VtPeWP50NoJjd26rnAdUI=" crossorigin="anonymous"><link rel="stylesheet" href="/blog.min.css?v=1.2.0"></head><body><div class="container"><div class="text-right mb-3"><div class="dropdown"><button type="button" class="btn btn-sm dropdown-toggle" data-toggle="dropdown">EN</button><div class="dropdown-menu"><a href="/br/posts/2019/08/28/arquitetura-de-microsservicos-com-aspnet-core.html" class="dropdown-item">BR</a></div></div></div><div class="header"><h1><a href="/">Full-Stack Applications</a></h1><div class="techs"><svg><use href="/images/techs.svg#netcore"/></svg> <svg><use href="/images/techs.svg#vue"/></svg> <svg><use href="/images/techs.svg#postgresql"/></svg> <svg><use href="/images/techs.svg#rabbitmq"/></svg> <svg><use href="/images/techs.svg#nginx"/></svg> <svg><use href="/images/techs.svg#ubuntu"/></svg> <svg><use href="/images/techs.svg#aws"/></svg> <svg><use href="/images/techs.svg#github"/></svg> <svg><use href="/images/techs.svg#circleci"/></svg></div></div><form method="get" action="https://www.google.com/search" class="google-search"><input type="hidden" name="sitesearch" value="fullstack.app"> <input type="text" name="q" class="form-control form-control-sm" placeholder="Google"></form><small>28 August 2019</small><h1>Microservice architecture with ASP.NET Core</h1><figure><img src="/posts/2019/08/28/cover.svg" alt="Microservices"></figure><p>To implement the microservice architecture pattern, we build a collection of APIs with specific responsibilities that work together and communicate through events. Let's see how we can do this.</p><p>Before we begin, it's important to know why we are implementing this pattern. To learn more about microservice architecture and its benefits, you can read the articles by <a href="https://microservices.io">Chris Richardson</a>. There is also an article about microservices in the <a href="https://docs.microsoft.com/en-us/azure/architecture/microservices/introduction">Microsoft documentation</a>.</p><p>To show and learn together how we can implement the microservice architecture, I will work on a solution focused on the food retail business. This solution is an open source project called <a href="https://github.com/storefront-community">Storefront Community</a>.</p><p>The business goal is to reduce the waiting time and offer convenience to the customers of the restaurants. As solution we will deliver a self-order kiosk (a.k.a. self-service terminal) where customers can order meals on their own. Techcnically, to build the backend of this solution by adopting the microservice architecture, I will essentially follow these three steps:</p><ol><li><a href="#create-an-api-gateway">Create an API gateway</a></li><li><a href="#configure-an-event-bus">Configure an event bus</a></li><li><a href="#build-responsibility-based-apis">Build responsibility-based APIs</a></li></ol><p></p><p>But to ensure the development of the project in a sustainable way, the following processes are very important and should be considered:</p><ul><li><b>Automated tests</b>: Automated tests enables us to test all the features of our services efficiently before releasing a new version. This considerably minimizes the incidence of bugs in new and old features (regression testing). I will publish a post about how can we write <i>automated tests for ASP.NET Core API with xUnit</i>.</li><li><b>CI/CD</b>: A continuous integration (CI) and continuous delivery (CD) tool performs automated tasks after source code changes made by the team and submitted to the version control. These tools provide test automation and can store artifacts (e.g. compiled releases, test reports, etc) and can also deploy new versions automatically. I will publish a post about how we can configure <i>ASP.NET Core on CircleCI</i>.</li><li><b>Error logging</b>: It is very important to monitor our applications against failures. There are libraries and logging tools (SaaS) that we can use to capture, trace, manage errors and notify the team automatically. Thus, errors will be reported by the tool and not by users, with the possibility of fix these errors before they even notice the problem. I will publish a post about <i>error logging in ASP.NET Core with Sentry</i>.</li></ul><p></p><h2 id="create-an-api-gateway">Create an API gateway</h2><p>Once we decided to implement the microservice architecture pattern, we'll need an API gateway that will act as a single entry point responsible for routing all requests to the other services (other APIs).</p><p>To accomplish this task you can refer to a post I wrote about implementing an <a href="/posts/2019/08/20/api-gateway-with-aspnet-core-and-ocelot.html">API gateway with ASP.NET Core and Ocelot</a>. You can also find information about this topic in the <a href="https://docs.microsoft.com/en-us/dotnet/architecture/microservices/multi-container-microservice-net-applications/implement-api-gateways-with-ocelot">Microsoft doumentation</a>.</p><h2 id="configure-an-event-bus">Configure an event bus</h2><p>The services are intended to play a specific part of the business and encapsulate their implementation logic and persistence strategy. However, they need to communicate with each other in order to work together to meet business needs.</p><p>The communication between services will take place through events and, to be established, three agents are needed:</p><ul><li><b>Event bus</b>: The channel by which the events are transmitted.</li><li><b>Publisher</b>: The service that will broadcast events to the event bus when updating its data.</li><li><b>Subscriber</b>: The service that will listen to one or more events through the event bus and will be notified when these events are triggered.</li></ul><p></p><p>I will publish a post about how we can implement an <i>event bus with RabbitMQ and ASP.NET Core</i>. I also suggest you read the Microsoft's article <a href="https://docs.microsoft.com/en-us/dotnet/architecture/microservices/multi-container-microservice-net-applications/integration-event-based-microservice-communications">implementing event-based communication between microservices (integration events) </a>and articles related to RabbitMQ.</p><h2 id="build-responsibility-based-apis">Build responsibility-based APIs</h2><p>We'll plan our services to have single-responsibility, that way the teams can focus on developing, maintaining and deploying each independently.</p><p>Understanding and defining single responsibility for each service is a delicate task and we must do this in a planned way. Keep in mind that we will refactor and continually improve our strategy based on business requirements.</p><p>This project aims to meet a need of the food retail business. Technically, I will build a backend for a <a href="https://kiosk.storefront.community">self-order kiosk</a> and also a <a href="https://menu.storefront.community">menu board</a>. These two apps gives us a good ideia of what we intend to achieve.</p><p>In the next posts I'll write about the planned microservice architecture and how it will be built.</p><div class="author"><img src="/images/marxjmoura.jpg" alt="marxjmoura"><div><p class="mb-3">I'm Marx J. Moura. In this blog I write about microservice architecture and web application development.</p><p><a href="https://github.com/marxjmoura/" class="p-1"><i class="fab fa-lg fa-github"></i> </a><a href="https://www.linkedin.com/in/marxjmoura/" class="p-1"><i class="fab fa-lg fa-linkedin"></i></a></p></div></div><div id="disqus_thread"></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/js/all.min.js" integrity="sha256-xzrHBImM2jn9oDLORlHS1/0ekn1VyypEkV1ALvUx8lU=" crossorigin="anonymous"></script><script src="/blog.min.js?v=1.2.0"></script><script>var disqus_config = function () {
      this.page.url = 'https://fullstack.app/posts/2019/08/28/microservice-architecture-with-aspnet-core.html';
      this.page.identifier = '2019/08/28/microservice-architecture-with-aspnet-core';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://fullstack-app.disqus.com/embed.js';
      s.setAttribute('data-timestamp', + new Date());
      (d.head || d.body).appendChild(s);
    })();</script></body></html>